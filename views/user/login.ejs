<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <title>Ariane Motors-EV franchise</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/frontend/assets/imgs/theme/am_logo_tiny.png">
    <!-- Template CSS -->
    <link rel="stylesheet" href="/frontend/assets/css/main.css?v=3.4">
    <!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!--Fa icon cdn-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
   
    
</head>

<body>
<style>
    .error-message{
        display: none;
        color: red;
        font-size: small;
    }
    .pwdtogglebutton{
        border: none;
        background-color: white;
    }
    

</style>
<header class="header-area header-style-1 header-height-2">
    
</header>
    <main class="main">
        <div class="page-header breadcrumb-wrap">
            <div class="container d-flex justify-content-between">
                <div class="breadcrumb">
                    <a href="/" rel="nofollow">Home</a>
                    <span> Login</span>
                </div>
                <div class="logo">
                    <a href="/"><img src="/frontend/assets/imgs/theme/am_logo.png" height="50px" alt="logo"></a>
                </div>
            </div>
        </div>
        <section class="pt-150 pb-150">
            <div class="container p-5 d-flex justify-content-center ">
             
                  
                            <div class="col-lg-5">
                                <div class="login_wrap widget-taber-content p-30 background-white border-radius-10 mb-md-5 mb-lg-0 mb-sm-5">
                                    <div class="padding_eight_all bg-white">
                                        <div class="heading_s1">
                                            <h3 class="mb-30">Login</h3>
                                        </div>
                                        <form id="loginForm">
                                            <div class="form-group ">
                                                <input type="text" name="email" placeholder="Your Email">
                                            </div>
                                            <div class="form-group pwd-grp d-flex">
                                                <input  type="password" name="password" class="loginpassword" placeholder="Password" >
                                                <button type="button" class="pwdtogglebutton"><i class="fa fa-eye"></i></button>
                                            </div>
                                            <div class="login_footer form-group">
                                                <!-- <div class="chek-form">
                                                    <div class="custome-checkbox">
                                                        <input class="form-check-input" type="checkbox" name="checkbox" id="exampleCheckbox1" value="">
                                                        <label class="form-check-label" for="exampleCheckbox1"><span>Remember me</span></label>
                                                    </div>
                                                </div> -->
                                                <p class="text-danger" id="loginError" hidden></p>
                                                <a class="text-muted" href="/forgotpwd">Forgot password?</a>
                                            </div>
                                            <div class="form-group d-flex justify-content-center">
                                                <button type="submit" class="btn btn-primary btn-fill-out btn-block hover-up" name="login">Log in</button>
                                            </div>
                                        </form>
                                        <div class="divider-text-center mt-15 mb-15">
                                            <span> or</span>
                                        </div>
                                        <ul class="btn-login list_none text-center mb-15">

                                            <li><a href="/auth/google" class="btn btn-google hover-up">Login With Google</a></li>
                                        </ul>
                                        <div class="text-muted text-center">Don't have an account? <a href="/signup">Register now</a></div>
                                    </div>
                                </div>
                            </div>
                            <% if(message) {%>
                            <script>
                                
                                Swal.fire({
                                title: "Error!",
                                text: "<%= message%>",
                                icon: "error"
                              });
                            </script>
                            <% } %>
                         
                
            </div>
        </section>
    </main>
   <%- include('../partials/user/footer') %>
    <script>
        
        document.addEventListener('DOMContentLoaded',function(){
            //toggler for admin


            //eye button for password toggle
            const toggleButtons=document.querySelectorAll(".pwdtogglebutton")
            
            toggleButtons.forEach(button=>{
                button.addEventListener("click",()=>{
                    const passwordInput=button.previousElementSibling
                const icon=button.querySelector("i")
            const isPassword=passwordInput.type==="password"
            passwordInput.type=isPassword?"text":"password"

            icon.classList.toggle("fa-eye-slash",isPassword)
            icon.classList.toggle("fa-eye",!isPassword)
            })
            })
            

             const params=new URLSearchParams(window.location.search)
        if(params.get('blocked')=="true"){
            Swal.fire({
                icon:"error",
                title:"Account Blocked",
                text:"Your account is blocked by admin",
                confirmButtonText:"OK"
            })
        }
        //login form submission
        const loginForm=document.getElementById('loginForm')
        const loginError=document.getElementById('loginError')
        loginForm.addEventListener('submit',async function(e){
            e.preventDefault()
            const loginFormData=new FormData(loginForm)
            const data={
                email:loginForm.email.value,
                password:loginForm.password.value
            }
            await fetch('/login',{
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body:JSON.stringify(data)
            }).then(res=>res.json())
            .then(result=>{
                if(result.success){
                    window.location.href=result.redirectUrl
                }else{
                    loginError.removeAttribute('hidden')
                    loginError.textContent='*'+result.message
                }
            })
        })
    })

    </script>
</body>

</html>